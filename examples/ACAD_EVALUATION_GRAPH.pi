import unknown.

/* DWG ACAD_EVALUATION_GRAPH field packing problem.
   examples/unknown generated example, needs picat-lang.org.
   Usage: picat [-g go2] examples/ACAD_EVALUATION_GRAPH.pi
*/

main => go1,
        go2,
        go3,
        go4.

go1 ?=> def(1,S,Fields).
go2 ?=> def(2,S,Fields).
go3 ?=> def(3,S,Fields).
go4 ?=> def(4,S,Fields).

def(1,S,Fields) =>
  println("ACAD_EVALUATION_GRAPH: 0x2E3 (230) test/test-data/example_2010.dxf:"),
  S = "00100000001010000000101000000011001001000000100000001001011111110111111101111111011111100111111101111111011111110111111100011111011111110111111101111111011001110111111101111111011111110111110001100000001100100000001001100010010011",
  % name: [1] bits, [2] value, [3] positions, [4] name, [5] dxfcode
  Fields = [
    new_struct('H330', ["00110000", '6.0.0', []]), % 2E4 [192,199]
    new_struct('BL96', ["0010000000", 1, []]),  % [1,10] has_graph
    new_struct('BL97', ["0010000000", 1, []]),  % [43,52] unknown_bl
    new_struct('BL91', ["01", 0, []]),          % ... nodeid
    new_struct('BL93', ["0010010000", 32, []]), % [33,42] edge_flags
    new_struct('BL95', ["0010000000", 1, []]),  % [205,214] num_evalexpr
    new_struct('H360', ["01000000", '8.0.0', []]), % 2E2 evalexpr [[12,19],[22,29],[206,213]]
    new_struct('BL92', ["0001111101111111011111110111111101", -1, []]) % [121,154] nodes_edges
  ],
  go(S,Fields).

/*
fixed = [[1,10],[33,42],[43,52],[121,154],[192,199],[205,214]]
field = H330(00110000,6.0.0,[[192,199]])
field = BL96(0010000000,1,[[1,10]])
field = BL97(0010000000,1,[[43,52]])
field = BL91(01,0,[[12,13],[20,21],[22,23],[30,31],[55,56],[57,58],[65,66],[73,74],[81,82],[89,90],[97,98],[105,106],[113,114],[157,158],[161,162],[169,170],[177,178],[185,186],[202,203],[217,218],[222,223],[225,226],[228,229]])
field = BL93(0010010000,32,[[33,42]])
field = BL95(0010000000,1,[[205,214]])
field = H360(01000000,8.0.0,[[12,19],[22,29]])
field = BL92(0001111101111111011111110111111101,-1,[[121,154]])
*/

def(2,S,Fields) =>
  println("ACAD_EVALUATION_GRAPH: 0x2E3 (231) test/test-data/example_2013.dxf:"),
  S = "001000000010100000001010000000110010010000001000000010010111111101111111011111110111111001111111011111110111111101111111000111110111111101111111011111110110011101111111011111110111111101111100011000000011001000000010011000100101010",
  % [1] bits, [2] value, [3] positions
  Fields = [
    new_struct('H330', ["00110000", '6.0.0', []]), % 2E4 [192,199]
    new_struct('BL96', ["0010000000", 1, []]),  % [1,10]
    new_struct('BL97', ["0010000000", 1, []]),  % [43,52] unknown
    new_struct('BL91', ["01", 0, []]),          % ...
    new_struct('BL93', ["0010010000", 32, []]), % [33,42] <BL97
    new_struct('BL95', ["0010000000", 1, []]),  % [205,214] num_nodes
    new_struct('H360', ["01000000", '8.0.0', []]), % 2E2 [[2,9]-,[12,19],[22,29],[37,44]-,[44,51]-,[206,213]!]
    new_struct('BL92', ["0001111101111111011111110111111101", -1, []]) % [121,154]
  ],
  go(S,Fields).

/* =>
fixed = [[1,10],[33,42],[43,52],[121,154],[192,199],[205,214]]
field = H330(00110000,6.0.0,[[192,199]])
field = BL96(0010000000,1,[[1,10]])
field = BL97(0010000000,1,[[43,52]])
field = BL91(01,0,[[12,13],[20,21],[22,23],[30,31],[55,56],[57,58],[65,66],[73,74],[81,82],[89,90],[97,98],[105,106],[113,114],[157,158],[161,162],[169,170],[177,178],[185,186],[202,203],[217,218],[222,223],[225,226],[227,228],[229,230]])
field = BL93(0010010000,32,[[33,42]])
field = BL95(0010000000,1,[[205,214]])
field = H360(01000000,8.0.0,[[12,19],[22,29]])
field = BL92(0001111101111111011111110111111101,-1,[[121,154]])
*/

def(3,S,Fields) =>
  println("ACAD_EVALUATION_GRAPH:  0x1E9E4C (103) test/test-data/2004/CascoUrbano.dxf:"),
  S = "0101010101000000001000010000111101001111001001010110001000110000010001100000000000000000001100000010011",
  % [1] bits, [2] value, [3] positions
  Fields = [
    new_struct('REA330', ["00100001000011110100111100100101", '4.3.1E9E4B', []]), % [17,48]
    new_struct('H330', ["0110000000000000", 'c.1.1', []]), % [69,84]
    new_struct('BL96', ["01", 0, []]),  % 
    new_struct('BL97', ["01", 0, []])  %
  ],
  go(S,Fields).

def(4,S,Fields) =>
  println("ACAD_EVALUATION_GRAPH:  0x2E3 (270) test/test-data/example_2007.dxf"),
  S = "001000000010100000001010000000110010010000001000000010010111111101111111011111110111111001111111011111110111111101111111000111110111111101111111011111110110011101111111011111110111111101111100011000000011001000000010011000100100000001001000011100000000000000000000011000",
  % name: [1] bits, [2] value, [3] positions, [4] name, [5] dxfcode
  Fields = [
    new_struct('H330', ["00110000", '6.0.0', []]), % 2E4 [192,199]
    new_struct('BL96', ["0010000000", 1, []]),  % [1,10] has_graph
    new_struct('BL97', ["0010000000", 1, []]),  % [43,52] unknown_bl
    new_struct('BL91', ["01", 0, []]),          % ... nodeid
    new_struct('BL93', ["0010010000", 32, []]), % [33,42] edge_flags
    new_struct('BL95', ["0010000000", 1, []]),  % [205,214] num_evalexpr
    new_struct('H360', ["01000000", '8.0.0', []]), % 2E2 evalexpr [[12,19],[22,29],[206,213]]
    new_struct('BL92', ["0001111101111111011111110111111101", -1, []]), % [121,154] nodes_edges
    new_struct('BL92', ["0001111101111111011111110111111101", -1, []]), %
    new_struct('BL92', ["0001111101111111011111110111111101", -1, []]), %
    new_struct('BL92', ["0001111101111111011111110111111101", -1, []]) %
  ],
  go(S,Fields).
